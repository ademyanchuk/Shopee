Experiment: exp_10-04-2021-11-16
Training with a single process on 1 GPUs.
Git commit hash: f53e036
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b0_ns-c0e6a31c.pth)
Model 'ArcFaceNet' with backbone: tf_efficientnet_b0_ns created, param count: 7_488_380
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 30.1413
Epoch 0 - avg val score: 0.5947, th: nan
epoch step: lr: 0.0000050
Epoch 0 - Save @ score: 0.5947
Epoch 1 - avg train loss: 29.8074
Epoch 1 - avg val score: 0.5543, th: nan
epoch step: lr: 0.0001045
Epoch 2 - avg train loss: 28.3441
Epoch 2 - avg val score: 0.5948, th: nan
epoch step: lr: 0.0002040
Epoch 2 - Save @ score: 0.5948
Epoch 3 - avg train loss: 25.0421
Epoch 3 - avg val score: 0.7143, th: nan
epoch step: lr: 0.0003035
Epoch 3 - Save @ score: 0.7143
Epoch 4 - avg train loss: 20.7595
Epoch 4 - avg val score: 0.7435, th: nan
epoch step: lr: 0.0004030
Epoch 4 - Save @ score: 0.7435
Epoch 5 - avg train loss: 16.9871
Epoch 5 - avg val score: 0.7574, th: nan
epoch step: lr: 0.0005025
Epoch 5 - Save @ score: 0.7574
Epoch 6 - avg train loss: 14.3694
Epoch 6 - avg val score: 0.7637, th: nan
epoch step: lr: 0.0006020
Epoch 6 - Save @ score: 0.7637
Epoch 7 - avg train loss: 12.7119
Epoch 7 - avg val score: 0.7625, th: nan
epoch step: lr: 0.0007015
Epoch 8 - avg train loss: 11.6690
Epoch 8 - avg val score: 0.7665, th: nan
epoch step: lr: 0.0008010
Epoch 8 - Save @ score: 0.7665
Epoch 9 - avg train loss: 10.8336
Epoch 9 - avg val score: 0.7695, th: nan
epoch step: lr: 0.0009005
Epoch 9 - Save @ score: 0.7695
Epoch 10 - avg train loss: 10.2032
Epoch 10 - avg val score: 0.7679, th: nan
epoch step: lr: 0.0005000
Epoch 11 - avg train loss: 7.9618
Epoch 11 - avg val score: 0.7733, th: nan
epoch step: lr: 0.0004218
Epoch 11 - Save @ score: 0.7733
Epoch 12 - avg train loss: 6.6981
Epoch 12 - avg val score: 0.7761, th: nan
epoch step: lr: 0.0003456
Epoch 12 - Save @ score: 0.7761
Epoch 13 - avg train loss: 5.9198
Epoch 13 - avg val score: 0.7781, th: nan
epoch step: lr: 0.0002731
Epoch 13 - Save @ score: 0.7781
Epoch 14 - avg train loss: 5.3338
Epoch 14 - avg val score: 0.7794, th: nan
epoch step: lr: 0.0002062
Epoch 14 - Save @ score: 0.7794
Epoch 15 - avg train loss: 4.8340
Epoch 15 - avg val score: 0.7800, th: nan
epoch step: lr: 0.0001465
Epoch 15 - Save @ score: 0.7800
Epoch 16 - avg train loss: 4.4679
Epoch 16 - avg val score: 0.7800, th: nan
epoch step: lr: 0.0000956
Epoch 16 - Save @ score: 0.7800
Epoch 17 - avg train loss: 4.1549
Epoch 17 - avg val score: 0.7810, th: nan
epoch step: lr: 0.0000546
Epoch 17 - Save @ score: 0.7810
Epoch 18 - avg train loss: 3.9231
Epoch 18 - avg val score: 0.7807, th: nan
epoch step: lr: 0.0000246
Epoch 19 - avg train loss: 3.7948
Epoch 19 - avg val score: 0.7804, th: nan
epoch step: lr: 0.0000063
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_10-04-2021-11-16_f0_score.pth' (epoch 18)
validation for fold: 0, score: 0.7809608076317602
