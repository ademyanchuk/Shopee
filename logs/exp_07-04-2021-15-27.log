Experiment: exp_07-04-2021-15-27
Training with a single process on 1 GPUs.
Git commit hash: e7fe43f
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet50d_ra2-464e36ba.pth)
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b1_ns-99dd0c41.pth)
Model 'ArcFaceNet' with backbones: resnet50d and tf_efficientnet_b1_ns created, param count: 37_391_744
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 29.2989
Epoch 0 - avg val score: 0.6877, th: nan
epoch step: lr: 0.0000050
Epoch 0 - Save @ score: 0.6877
Epoch 1 - avg train loss: 28.8710
Epoch 1 - avg val score: 0.6778, th: nan
epoch step: lr: 0.0002040
Epoch 2 - avg train loss: 25.3708
Epoch 2 - avg val score: 0.7502, th: nan
epoch step: lr: 0.0004030
Epoch 2 - Save @ score: 0.7502
Epoch 3 - avg train loss: 19.8007
Epoch 3 - avg val score: 0.7609, th: nan
epoch step: lr: 0.0006020
Epoch 3 - Save @ score: 0.7609
Epoch 4 - avg train loss: 16.2982
Epoch 4 - avg val score: 0.7616, th: nan
epoch step: lr: 0.0008010
Epoch 4 - Save @ score: 0.7616
Epoch 5 - avg train loss: 14.4175
Epoch 5 - avg val score: 0.7554, th: nan
epoch step: lr: 0.0008536
Epoch 6 - avg train loss: 12.2842
Epoch 6 - avg val score: 0.7639, th: nan
epoch step: lr: 0.0007940
Epoch 6 - Save @ score: 0.7639
Epoch 7 - avg train loss: 10.1261
Epoch 7 - avg val score: 0.7645, th: nan
epoch step: lr: 0.0007271
Epoch 7 - Save @ score: 0.7645
Epoch 8 - avg train loss: 8.3778
Epoch 8 - avg val score: 0.7684, th: nan
epoch step: lr: 0.0006547
Epoch 8 - Save @ score: 0.7684
Epoch 9 - avg train loss: 7.0182
Epoch 9 - avg val score: 0.7698, th: nan
epoch step: lr: 0.0005784
Epoch 9 - Save @ score: 0.7698
Epoch 10 - avg train loss: 5.8953
Epoch 10 - avg val score: 0.7753, th: nan
epoch step: lr: 0.0005002
Epoch 10 - Save @ score: 0.7753
Epoch 11 - avg train loss: 4.9180
Epoch 11 - avg val score: 0.7728, th: nan
epoch step: lr: 0.0004221
Epoch 12 - avg train loss: 4.0791
Epoch 12 - avg val score: 0.7728, th: nan
epoch step: lr: 0.0003458
Epoch 13 - avg train loss: 3.3829
Epoch 13 - avg val score: 0.7723, th: nan
epoch step: lr: 0.0002734
Epoch 14 - avg train loss: 2.7863
Epoch 14 - avg val score: 0.7724, th: nan
epoch step: lr: 0.0002065
Epoch 15 - avg train loss: 2.3179
Epoch 15 - avg val score: 0.7722, th: nan
epoch step: lr: 0.0001469
