Experiment: exp_14-04-2021-07-18
Training with a single process on 1 GPUs.
Git commit hash: 1cee613
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b3_ns-9d44bf68.pth)
Model 'ArcFaceNet' with backbone: tf_efficientnet_b3_ns created, param count: 14_309_160
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0005
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 25.3371
Epoch 0 - avg val score: 0.6314, th: nan
epoch step: lr: 0.0000010
Epoch 0 - Save @ score: 0.6314
Epoch 1 - avg train loss: 25.2093
Epoch 1 - avg val score: 0.6341, th: nan
epoch step: lr: 0.0000509
Epoch 1 - Save @ score: 0.6341
Epoch 2 - avg train loss: 23.7605
Epoch 2 - avg val score: 0.5319, th: nan
epoch step: lr: 0.0001008
Epoch 3 - avg train loss: 20.6898
Epoch 3 - avg val score: 0.7201, th: nan
epoch step: lr: 0.0001507
Epoch 3 - Save @ score: 0.7201
Epoch 4 - avg train loss: 16.8519
Epoch 4 - avg val score: 0.7415, th: nan
epoch step: lr: 0.0002006
Epoch 4 - Save @ score: 0.7415
Epoch 5 - avg train loss: 13.4869
Epoch 5 - avg val score: 0.7457, th: nan
epoch step: lr: 0.0002505
Epoch 5 - Save @ score: 0.7457
Epoch 6 - avg train loss: 10.9458
Epoch 6 - avg val score: 0.7475, th: nan
epoch step: lr: 0.0003004
Epoch 6 - Save @ score: 0.7475
Epoch 7 - avg train loss: 9.1242
Epoch 7 - avg val score: 0.7478, th: nan
epoch step: lr: 0.0003503
Epoch 7 - Save @ score: 0.7478
Epoch 8 - avg train loss: 7.9528
Epoch 8 - avg val score: 0.7452, th: nan
epoch step: lr: 0.0004002
Epoch 9 - avg train loss: 7.1470
Epoch 9 - avg val score: 0.7469, th: nan
epoch step: lr: 0.0004501
Epoch 10 - avg train loss: 6.6025
Epoch 10 - avg val score: 0.7483, th: nan
epoch step: lr: 0.0002503
Epoch 10 - Save @ score: 0.7483
Epoch 11 - avg train loss: 4.7108
Epoch 11 - avg val score: 0.7498, th: nan
epoch step: lr: 0.0002112
Epoch 11 - Save @ score: 0.7498
Epoch 12 - avg train loss: 3.7227
Epoch 12 - avg val score: 0.7481, th: nan
epoch step: lr: 0.0001731
Epoch 13 - avg train loss: 3.0887
Epoch 13 - avg val score: 0.7489, th: nan
epoch step: lr: 0.0001369
Epoch 14 - avg train loss: 2.5839
Epoch 14 - avg val score: 0.7492, th: nan
epoch step: lr: 0.0001035
Epoch 15 - avg train loss: 2.2039
Epoch 15 - avg val score: 0.7476, th: nan
epoch step: lr: 0.0000737
Epoch 16 - avg train loss: 1.9268
Epoch 16 - avg val score: 0.7477, th: nan
epoch step: lr: 0.0000482
Epoch 17 - avg train loss: 1.6829
Epoch 17 - avg val score: 0.7479, th: nan
epoch step: lr: 0.0000277
Epoch 18 - avg train loss: 1.5472
Epoch 18 - avg val score: 0.7453, th: nan
epoch step: lr: 0.0000127
Epoch 19 - avg train loss: 1.4517
Epoch 19 - avg val score: 0.7475, th: nan
epoch step: lr: 0.0000036
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_14-04-2021-07-18_f0_score.pth' (epoch 12)
Image model score: 0.7497954049555628 [for exp: exp_14-04-2021-07-18, fold: 0]
Text model score: 0.7171399165712931 [for exp: exp_14-04-2021-07-18, fold: 0]
validation for fold: 0, score: 0.8377594259404654
