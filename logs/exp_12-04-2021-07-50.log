Experiment: exp_12-04-2021-07-50
Training with a single process on 1 GPUs.
Git commit hash: 2273abd
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b1_ns-99dd0c41.pth)
Model 'ArcFaceNet' with backbone: tf_efficientnet_b1_ns created, param count: 13_464_608
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0003
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 24.3705
Epoch 0 - avg val score: 0.5824, th: nan
epoch step: lr: 0.0000100
Epoch 0 - Save @ score: 0.5824
Epoch 1 - avg train loss: 23.9952
Epoch 1 - avg val score: 0.5320, th: nan
epoch step: lr: 0.0000680
Epoch 2 - avg train loss: 22.8839
Epoch 2 - avg val score: 0.5561, th: nan
epoch step: lr: 0.0001260
Epoch 3 - avg train loss: 20.4610
Epoch 3 - avg val score: 0.6992, th: nan
epoch step: lr: 0.0001840
Epoch 3 - Save @ score: 0.6992
Epoch 4 - avg train loss: 17.3899
Epoch 4 - avg val score: 0.7206, th: nan
epoch step: lr: 0.0002420
Epoch 4 - Save @ score: 0.7206
Epoch 5 - avg train loss: 14.5492
Epoch 5 - avg val score: 0.7286, th: nan
epoch step: lr: 0.0002252
Epoch 5 - Save @ score: 0.7286
Epoch 6 - avg train loss: 11.7524
Epoch 6 - avg val score: 0.7341, th: nan
epoch step: lr: 0.0001967
Epoch 6 - Save @ score: 0.7341
Epoch 7 - avg train loss: 9.6079
Epoch 7 - avg val score: 0.7350, th: nan
epoch step: lr: 0.0001661
Epoch 7 - Save @ score: 0.7350
Epoch 8 - avg train loss: 8.0588
Epoch 8 - avg val score: 0.7404, th: nan
epoch step: lr: 0.0001349
Epoch 8 - Save @ score: 0.7404
Epoch 9 - avg train loss: 6.8463
Epoch 9 - avg val score: 0.7402, th: nan
epoch step: lr: 0.0001043
Epoch 10 - avg train loss: 5.9139
Epoch 10 - avg val score: 0.7390, th: nan
epoch step: lr: 0.0000758
Epoch 11 - avg train loss: 5.2373
Epoch 11 - avg val score: 0.7373, th: nan
epoch step: lr: 0.0000505
Epoch 12 - avg train loss: 4.7508
Epoch 12 - avg val score: 0.7379, th: nan
epoch step: lr: 0.0000296
Epoch 13 - avg train loss: 4.4140
Epoch 13 - avg val score: 0.7393, th: nan
epoch step: lr: 0.0000139
Epoch 14 - avg train loss: 4.1843
Epoch 14 - avg val score: 0.7392, th: nan
epoch step: lr: 0.0000043
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_12-04-2021-07-50_f0_score.pth' (epoch 9)
validation for fold: 0, score: 0.7403931951649716
