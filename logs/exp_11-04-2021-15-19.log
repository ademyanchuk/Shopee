Experiment: exp_11-04-2021-15-19
Training with a single process on 1 GPUs.
Git commit hash: e625434
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b0_ns-c0e6a31c.pth)
Model 'ArcFaceNet' with backbone: tf_efficientnet_b0_ns created, param count: 7_488_380
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 30.1425
Epoch 0 - avg val score: 0.6389, th: nan
epoch step: lr: 0.0000050
Epoch 0 - Save @ score: 0.6389
Epoch 1 - avg train loss: 29.7776
Epoch 1 - avg val score: 0.6030, th: nan
epoch step: lr: 0.0005025
Epoch 2 - avg train loss: 26.3354
Epoch 2 - avg val score: 0.7276, th: nan
epoch step: lr: 0.0009755
Epoch 2 - Save @ score: 0.7276
Epoch 3 - avg train loss: 20.6023
Epoch 3 - avg val score: 0.7375, th: nan
epoch step: lr: 0.0009455
Epoch 3 - Save @ score: 0.7375
Epoch 4 - avg train loss: 15.6765
Epoch 4 - avg val score: 0.7399, th: nan
epoch step: lr: 0.0009045
Epoch 4 - Save @ score: 0.7399
Epoch 5 - avg train loss: 12.5721
Epoch 5 - avg val score: 0.7412, th: nan
epoch step: lr: 0.0008536
Epoch 5 - Save @ score: 0.7412
Epoch 6 - avg train loss: 10.6240
Epoch 6 - avg val score: 0.7412, th: nan
epoch step: lr: 0.0007939
Epoch 6 - Save @ score: 0.7412
Epoch 7 - avg train loss: 9.2586
Epoch 7 - avg val score: 0.7414, th: nan
epoch step: lr: 0.0007270
Epoch 7 - Save @ score: 0.7414
Epoch 8 - avg train loss: 8.2112
Epoch 8 - avg val score: 0.7427, th: nan
epoch step: lr: 0.0006545
Epoch 8 - Save @ score: 0.7427
Epoch 9 - avg train loss: 7.3037
Epoch 9 - avg val score: 0.7429, th: nan
epoch step: lr: 0.0005783
Epoch 9 - Save @ score: 0.7429
Epoch 10 - avg train loss: 6.5719
Epoch 10 - avg val score: 0.7420, th: nan
epoch step: lr: 0.0005000
Epoch 11 - avg train loss: 5.8915
Epoch 11 - avg val score: 0.7418, th: nan
epoch step: lr: 0.0004218
Epoch 12 - avg train loss: 5.3175
Epoch 12 - avg val score: 0.7408, th: nan
epoch step: lr: 0.0003456
Epoch 13 - avg train loss: 4.8372
Epoch 13 - avg val score: 0.7405, th: nan
epoch step: lr: 0.0002731
Epoch 14 - avg train loss: 4.4194
Epoch 14 - avg val score: 0.7410, th: nan
epoch step: lr: 0.0002062
Epoch 15 - avg train loss: 4.0685
Epoch 15 - avg val score: 0.7433, th: nan
epoch step: lr: 0.0001465
Epoch 15 - Save @ score: 0.7433
Epoch 16 - avg train loss: 3.7710
Epoch 16 - avg val score: 0.7416, th: nan
epoch step: lr: 0.0000956
Epoch 17 - avg train loss: 3.5529
Epoch 17 - avg val score: 0.7429, th: nan
epoch step: lr: 0.0000546
Epoch 18 - avg train loss: 3.3730
Epoch 18 - avg val score: 0.7417, th: nan
epoch step: lr: 0.0000246
Epoch 19 - avg train loss: 3.2601
Epoch 19 - avg val score: 0.7413, th: nan
epoch step: lr: 0.0000063
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_11-04-2021-15-19_f0_score.pth' (epoch 16)
validation for fold: 0, score: 0.743330979557078
