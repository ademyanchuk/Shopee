Experiment: exp_07-04-2021-08-39
Training with a single process on 1 GPUs.
Git commit hash: 4401fd1
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet50d_ra2-464e36ba.pth)
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b1_ns-99dd0c41.pth)
Model 'ArcFaceNet' with backbones: resnet50d and tf_efficientnet_b1_ns created, param count: 37_391_744
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 29.3003
Epoch 0 - avg val score: 0.6859, th: nan
epoch step: lr: 0.0000050
Epoch 0 - Save @ score: 0.6859
Epoch 1 - avg train loss: 28.8738
Epoch 1 - avg val score: 0.6815, th: nan
epoch step: lr: 0.0002040
Epoch 2 - avg train loss: 25.3503
Epoch 2 - avg val score: 0.7448, th: nan
epoch step: lr: 0.0004030
Epoch 2 - Save @ score: 0.7448
Epoch 3 - avg train loss: 19.7843
Epoch 3 - avg val score: 0.7521, th: nan
epoch step: lr: 0.0006020
Epoch 3 - Save @ score: 0.7521
Epoch 4 - avg train loss: 16.3240
Epoch 4 - avg val score: 0.7550, th: nan
epoch step: lr: 0.0008010
Epoch 4 - Save @ score: 0.7550
Epoch 5 - avg train loss: 14.3772
Epoch 5 - avg val score: 0.7542, th: nan
epoch step: lr: 0.0008536
Epoch 6 - avg train loss: 12.2641
Epoch 6 - avg val score: 0.7601, th: nan
epoch step: lr: 0.0007939
Epoch 6 - Save @ score: 0.7601
Epoch 7 - avg train loss: 10.1519
Epoch 7 - avg val score: 0.7594, th: nan
epoch step: lr: 0.0007270
Epoch 8 - avg train loss: 8.3996
Epoch 8 - avg val score: 0.7648, th: nan
epoch step: lr: 0.0006545
Epoch 8 - Save @ score: 0.7648
Epoch 9 - avg train loss: 7.0158
Epoch 9 - avg val score: 0.7611, th: nan
epoch step: lr: 0.0005783
Epoch 10 - avg train loss: 5.8980
Epoch 10 - avg val score: 0.7653, th: nan
epoch step: lr: 0.0005000
Epoch 10 - Save @ score: 0.7653
Epoch 11 - avg train loss: 4.9002
Epoch 11 - avg val score: 0.7648, th: nan
epoch step: lr: 0.0004218
Epoch 12 - avg train loss: 4.0855
Epoch 12 - avg val score: 0.7649, th: nan
epoch step: lr: 0.0003456
Epoch 13 - avg train loss: 3.3882
Epoch 13 - avg val score: 0.7642, th: nan
epoch step: lr: 0.0002731
Epoch 14 - avg train loss: 2.7761
Epoch 14 - avg val score: 0.7653, th: nan
epoch step: lr: 0.0002062
Epoch 14 - Save @ score: 0.7653
Epoch 15 - avg train loss: 2.3021
Epoch 15 - avg val score: 0.7651, th: nan
epoch step: lr: 0.0001465
Epoch 16 - avg train loss: 1.9520
Epoch 16 - avg val score: 0.7658, th: nan
epoch step: lr: 0.0000956
Epoch 16 - Save @ score: 0.7658
Epoch 17 - avg train loss: 1.6602
Epoch 17 - avg val score: 0.7665, th: nan
epoch step: lr: 0.0000546
Epoch 17 - Save @ score: 0.7665
Epoch 18 - avg train loss: 1.4980
Epoch 18 - avg val score: 0.7671, th: nan
epoch step: lr: 0.0000246
Epoch 18 - Save @ score: 0.7671
Epoch 19 - avg train loss: 1.3791
Epoch 19 - avg val score: 0.7648, th: nan
epoch step: lr: 0.0000063
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_07-04-2021-08-39_f0_score.pth' (epoch 19)
validation for fold: 0, score: 0.767082800258091
