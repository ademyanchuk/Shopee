Experiment: exp_29-04-2021-12-54
Training with a single process on 1 GPUs.
Git commit hash: d0bbb5e
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/ecanfnet_l0_ra2-e3e9ac50.pth)
Model 'ArcFaceNet' with backbone: eca_nfnet_l0 created, param count: 25_848_140
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0005
    weight_decay: 0.0

Parameter Group 1
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.025
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 27.8444
Epoch 0 - avg val score: 0.6938, th: nan
epoch step: lr: 0.0000100
epoch step: lr: 0.0000100
Epoch 0 - Save @ score: 0.6938
Epoch 1 - avg train loss: 27.6054
Epoch 1 - avg val score: 0.6677, th: nan
epoch step: lr: 0.0001733
epoch step: lr: 0.0083400
Epoch 2 - avg train loss: 24.6733
Epoch 2 - avg val score: 0.7312, th: nan
epoch step: lr: 0.0003367
epoch step: lr: 0.0166700
Epoch 2 - Save @ score: 0.7312
Epoch 3 - avg train loss: 19.8021
Epoch 3 - avg val score: 0.7390, th: nan
epoch step: lr: 0.0004523
epoch step: lr: 0.0226128
Epoch 3 - Save @ score: 0.7390
Epoch 4 - avg train loss: 16.2074
Epoch 4 - avg val score: 0.7404, th: nan
epoch step: lr: 0.0004174
epoch step: lr: 0.0208643
Epoch 4 - Save @ score: 0.7404
Epoch 5 - avg train loss: 13.4327
Epoch 5 - avg val score: 0.7474, th: nan
epoch step: lr: 0.0003753
epoch step: lr: 0.0187503
Epoch 5 - Save @ score: 0.7474
Epoch 6 - avg train loss: 11.5446
Epoch 6 - avg val score: 0.7464, th: nan
epoch step: lr: 0.0003276
epoch step: lr: 0.0163631
Epoch 7 - avg train loss: 10.2497
Epoch 7 - avg val score: 0.7504, th: nan
epoch step: lr: 0.0002766
epoch step: lr: 0.0138071
Epoch 7 - Save @ score: 0.7504
Epoch 8 - avg train loss: 9.2662
Epoch 8 - avg val score: 0.7488, th: nan
epoch step: lr: 0.0002244
epoch step: lr: 0.0111939
Epoch 9 - avg train loss: 8.3832
Epoch 9 - avg val score: 0.7515, th: nan
epoch step: lr: 0.0001734
epoch step: lr: 0.0086379
Epoch 9 - Save @ score: 0.7515
Epoch 10 - avg train loss: 7.7055
Epoch 10 - avg val score: 0.7528, th: nan
epoch step: lr: 0.0001258
epoch step: lr: 0.0062508
Epoch 10 - Save @ score: 0.7528
Epoch 11 - avg train loss: 7.0189
Epoch 11 - avg val score: 0.7526, th: nan
epoch step: lr: 0.0000836
epoch step: lr: 0.0041367
Epoch 12 - avg train loss: 6.4789
Epoch 12 - avg val score: 0.7549, th: nan
epoch step: lr: 0.0000487
epoch step: lr: 0.0023882
Epoch 12 - Save @ score: 0.7549
Epoch 13 - avg train loss: 6.0315
Epoch 13 - avg val score: 0.7555, th: nan
epoch step: lr: 0.0000226
epoch step: lr: 0.0010816
Epoch 13 - Save @ score: 0.7555
Epoch 14 - avg train loss: 5.7172
Epoch 14 - avg val score: 0.7555, th: nan
epoch step: lr: 0.0000065
epoch step: lr: 0.0002741
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_29-04-2021-12-54_f0_score.pth' (epoch 14)
DL model score: 0.7555409864041471 [for exp: exp_29-04-2021-12-54, fold: 0]
Tfidf model score: 0.7171399165712931 [for exp: exp_29-04-2021-12-54, fold: 0]
validation for fold: 0, score: 0.839050474184186
