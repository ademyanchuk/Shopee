Experiment: exp_03-04-2021-15-05
Training with a single process on 1 GPUs.
Git commit hash: 905d264
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/tf_efficientnet_b3_ns-9d44bf68.pth)
Model 'ArcFaceNet' with backbone: tf_efficientnet_b3_ns created, param count: 17_126_440
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.001
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 16.6239
Epoch 0 - avg val score: 0.6553, th: nan
epoch step: lr: 0.0000050
Epoch 0 - Save @ score: 0.6553
Epoch 1 - avg train loss: 16.4221
Epoch 1 - avg val score: 0.6543, th: nan
epoch step: lr: 0.0003367
Epoch 2 - avg train loss: 13.2370
Epoch 2 - avg val score: 0.7410, th: nan
epoch step: lr: 0.0006683
Epoch 2 - Save @ score: 0.7410
Epoch 3 - avg train loss: 9.0604
Epoch 3 - avg val score: 0.7471, th: nan
epoch step: lr: 0.0009455
Epoch 3 - Save @ score: 0.7471
Epoch 4 - avg train loss: 7.3010
Epoch 4 - avg val score: 0.7537, th: nan
epoch step: lr: 0.0009045
Epoch 4 - Save @ score: 0.7537
Epoch 5 - avg train loss: 5.7715
Epoch 5 - avg val score: 0.7581, th: nan
epoch step: lr: 0.0008536
Epoch 5 - Save @ score: 0.7581
Epoch 6 - avg train loss: 4.7086
Epoch 6 - avg val score: 0.7555, th: nan
epoch step: lr: 0.0007939
Epoch 7 - avg train loss: 3.9779
Epoch 7 - avg val score: 0.7561, th: nan
epoch step: lr: 0.0007270
Epoch 8 - avg train loss: 3.4185
Epoch 8 - avg val score: 0.7615, th: nan
epoch step: lr: 0.0006545
Epoch 8 - Save @ score: 0.7615
Epoch 9 - avg train loss: 2.9388
Epoch 9 - avg val score: 0.7596, th: nan
epoch step: lr: 0.0005783
Epoch 10 - avg train loss: 2.5299
Epoch 10 - avg val score: 0.7621, th: nan
epoch step: lr: 0.0005000
Epoch 10 - Save @ score: 0.7621
Epoch 11 - avg train loss: 2.1870
Epoch 11 - avg val score: 0.7619, th: nan
epoch step: lr: 0.0004218
Epoch 12 - avg train loss: 1.8915
Epoch 12 - avg val score: 0.7624, th: nan
epoch step: lr: 0.0003456
Epoch 12 - Save @ score: 0.7624
Epoch 13 - avg train loss: 1.6307
Epoch 13 - avg val score: 0.7664, th: nan
epoch step: lr: 0.0002731
Epoch 13 - Save @ score: 0.7664
Epoch 14 - avg train loss: 1.4200
Epoch 14 - avg val score: 0.7667, th: nan
epoch step: lr: 0.0002062
Epoch 14 - Save @ score: 0.7667
Epoch 15 - avg train loss: 1.2483
Epoch 15 - avg val score: 0.7652, th: nan
epoch step: lr: 0.0001465
Epoch 16 - avg train loss: 1.1161
Epoch 16 - avg val score: 0.7659, th: nan
epoch step: lr: 0.0000956
Epoch 17 - avg train loss: 1.0197
Epoch 17 - avg val score: 0.7655, th: nan
epoch step: lr: 0.0000546
Epoch 18 - avg train loss: 0.9472
Epoch 18 - avg val score: 0.7646, th: nan
epoch step: lr: 0.0000246
Epoch 19 - avg train loss: 0.9049
Epoch 19 - avg val score: 0.7654, th: nan
epoch step: lr: 0.0000063
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_03-04-2021-15-05_f0_score.pth' (epoch 15)
validation for fold: 0, score: 0.7666821015108646
