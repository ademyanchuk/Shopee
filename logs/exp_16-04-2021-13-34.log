Experiment: exp_16-04-2021-13-34
Training with a single process on 1 GPUs.
Git commit hash: 396ad25
Using CSV: /root/Projects/Shopee/meta_data/train_folds.csv
NumExpr defaulting to 4 threads.
Data: train size: 27399, val_size: 6851
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet50d_ra2-464e36ba.pth)
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet50d_ra2-464e36ba.pth)
Model 'ModelMoCo' with backbone: resnet50d created, param count: 49_152_192
Using optimizer: AdamW (
Parameter Group 0
    amsgrad: False
    betas: (0.9, 0.999)
    eps: 1e-08
    lr: 0.0005
    weight_decay: 0.0
)
AMP: 'NativeScaler'
Epoch 0 - avg train loss: 6.5431
Epoch 0 - avg val score: 0.6534, th: nan
epoch step: lr: 0.0000010
Epoch 0 - Save @ score: 0.6534
Epoch 1 - avg train loss: 5.8712
Epoch 1 - avg val score: 0.6552, th: nan
epoch step: lr: 0.0001008
Epoch 1 - Save @ score: 0.6552
Epoch 2 - avg train loss: 2.9310
Epoch 2 - avg val score: 0.6967, th: nan
epoch step: lr: 0.0002006
Epoch 2 - Save @ score: 0.6967
Epoch 3 - avg train loss: 1.8618
Epoch 3 - avg val score: 0.7041, th: nan
epoch step: lr: 0.0003004
Epoch 3 - Save @ score: 0.7041
Epoch 4 - avg train loss: 1.5193
Epoch 4 - avg val score: 0.7012, th: nan
epoch step: lr: 0.0004002
Epoch 5 - avg train loss: 1.3661
Epoch 5 - avg val score: 0.6994, th: nan
epoch step: lr: 0.0004268
Epoch 6 - avg train loss: 1.2524
Epoch 6 - avg val score: 0.6982, th: nan
epoch step: lr: 0.0003970
Epoch 7 - avg train loss: 1.1570
Epoch 7 - avg val score: 0.6988, th: nan
epoch step: lr: 0.0003636
Epoch 8 - avg train loss: 1.0816
Epoch 8 - avg val score: 0.6982, th: nan
epoch step: lr: 0.0003274
Epoch 9 - avg train loss: 1.0385
Epoch 9 - avg val score: 0.6991, th: nan
epoch step: lr: 0.0002893
Epoch 10 - avg train loss: 0.9830
Epoch 10 - avg val score: 0.6981, th: nan
epoch step: lr: 0.0002503
Epoch 11 - avg train loss: 0.9435
Epoch 11 - avg val score: 0.6998, th: nan
epoch step: lr: 0.0002112
Epoch 12 - avg train loss: 0.9097
Epoch 12 - avg val score: 0.6998, th: nan
epoch step: lr: 0.0001731
Epoch 13 - avg train loss: 0.8797
Epoch 13 - avg val score: 0.6967, th: nan
epoch step: lr: 0.0001369
Epoch 14 - avg train loss: 0.8571
Epoch 14 - avg val score: 0.7010, th: nan
epoch step: lr: 0.0001035
Epoch 15 - avg train loss: 0.8337
Epoch 15 - avg val score: 0.6994, th: nan
epoch step: lr: 0.0000737
Epoch 16 - avg train loss: 0.8163
Epoch 16 - avg val score: 0.6996, th: nan
epoch step: lr: 0.0000482
Epoch 17 - avg train loss: 0.8043
Epoch 17 - avg val score: 0.6991, th: nan
epoch step: lr: 0.0000277
Epoch 18 - avg train loss: 0.7944
Epoch 18 - avg val score: 0.6996, th: nan
epoch step: lr: 0.0000127
Epoch 19 - avg train loss: 0.7912
Epoch 19 - avg val score: 0.7001, th: nan
epoch step: lr: 0.0000036
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet50d_ra2-464e36ba.pth)
Loading pretrained weights from url (https://github.com/rwightman/pytorch-image-models/releases/download/v0.1-weights/resnet50d_ra2-464e36ba.pth)
Restoring model state from checkpoint...
Loaded checkpoint '/root/Projects/Shopee/models/exp_16-04-2021-13-34_f0_score.pth' (epoch 4)
Image model score: 0.7039874897264063 [for exp: exp_16-04-2021-13-34, fold: 0]
Text model score: 0.7171399165712931 [for exp: exp_16-04-2021-13-34, fold: 0]
validation for fold: 0, score: 0.8091454714379069
